✅ Como adicionar synchronized depois
Adicione essas estruturas:

java
Copiar
Editar
private static final ConcurrentMap<String, Object> userLocks = new ConcurrentHashMap<>();
private static final ConcurrentMap<String, Object> genreLocks = new ConcurrentHashMap<>();

private static Object getUserLock(String userId) {
    return userLocks.computeIfAbsent(userId, k -> new Object());
}

private static Object getGenreLock(String genre) {
    return genreLocks.computeIfAbsent(genre, k -> new Object());
}
E use dentro da predição:

java
Copiar
Editar
synchronized (getUserLock(user)) {
    synchronized (getGenreLock(genre)) {
        predicted += dot(userFactors.get(user), genreFactors.get(genre));
    }
}
